# 网络
## 宽带
### 主流网络运营商
* 中国电信宽带
* 中国移动铁通宽带
* 中国联通网通宽带
* 长城宽带
### 宽带的性能指标：带宽
* 带宽的实际含义:在给定时间等条件下流过特定区域的最大数据位数
* 带宽的常用单位是Mbps，即兆比每秒
* ADSL宽带速率一般为1Mbps、2Mbps、4Mbps、6Mbps
、8Mbps</br>光纤宽带速率一般为10Mbps、20Mbps、50Mbps、100Mbps、1Gbps
### 不同种类宽带的优缺点
| 宽带种类 | 特点 | 优点 | 缺点 |
| :------: | :------: | :------: | :------: |
| ADSL宽带 | 以电话为信号媒介，下行速度和上行速度不同 | 每个用户独享分配给自己的带宽，比较稳定 | 上网速度受电信部门的总出口带宽的影响，速度一般不高 |
| 社区宽带 | 通信光纤直接铺设到小区的中心机房，小区的各用户组成局域网，最后通过局域网共享主光纤实现上网 | 当整个小区上网的用户比较少，或在线用户比较少时，网速比较高 | 随着上网用户的增多，或上网高峰期，网速下降的同谋十分明显 |
| 光纤宽带 | 光纤网采用光导纤维作传输介质 | 传输距离长，传输率高，可达数千兆bps，抗干扰性强，不会受到电子监听设备的监听 | 价格较高，且需要高水平的安装技术，所以现在尚未普及 |

## 路由器
### 路由器（Router），是连接因特网中各局域网、广域网的设备，它会根据信道的情况自动选择和设定路由，以最佳路径，按前后顺序发送信号。
### 路由器常见性能指标
1. 吞吐量
    * 定义：路由器的包转发能力，一般分为整机和端口吞吐量
    * 单位：Mpps，即每秒可以转发多少百万个数据包
    * 低端的路由器包转发率只有几K到几十Kpps，而高端路由器则能达到几十Mpps（百万包每秒）甚至上百Mpps
2. 路由表能力
    * 定义：路由表内所容纳路由表项数量的极限
    * 单位：条数
    * 高速核心路由器应该能够支持至少25万条路由，平均每个目的地址至少提供2条路径，系统必须支持至少25个BGP对等以及至少50个IGP邻居
3. 背板能力
    * 定义：背板指输入与输出端口间的物理通路
    * 传统的路由器采用的是共享背板的结构，高性能路由器一般采用的是交换式结构。背板能力决定了路由器的吞吐量，背板能力只能在设计中体现，一般无法测试
4. 丢包率
    * 定义：核心路由器在稳定的持续负荷下，由于资源缺少而不能转发的数据包在应该转发的数据包中所占的比例
    * 单位：百分比
    * 计算方法:[(输入报文-输出报文)/输入报文]*100%
    * 丢包率与数据包长度以及包发送频率相关，通常,千兆网卡在流量大于200Mbps时,丢包率小于万分之五;百兆网卡在流量大于60Mbps时,丢包率小于万分之一
5. 时延
    * 定义：数据包第一个比特进入路由器到最后一个比特从核心路由器输出的时间间隔
    * 单位：毫秒，在测试中通常使用测试仪表发出测试包到收到数据包的时间间隔
    * 时延对网络性能影响较大， 作为高速路由器，在最差情况下， 要求对1518字节及以下的IP包时延均都小于1ms
6. 背靠背帧数
    * 定义：以最小帧间隔发送最多数据包不引起丢包时的数据包数量，用于测试核心路由器缓存能力
    * 单位：帧数
    * 测试方法：以最大速率向DUT传送特定数量的测试帧，并统计DUT转发的帧数
    * 指标越大越好，没有上限
### 主流路由器品牌
* 华为
* TP-LINK
* H3C
* 小米
* D-LINK
* Tenda
* 华硕路由器
* NETGEAR
* BUFFALO
* 思科

### 常用路由器分类
| 路由器种类 | 特点 | 优点 | 缺点 |
| :------: | :------: | :------: | :------: |
| 模块化路由器 | 该路由器的接口类型及部分扩展功能是可以根据用户的实际需求来配置的路由器，用户可以根据所要连接的网络类型来选择相应的模块| 当路由器某一部分故障，不影响其他部分正常工作。用户根据实际需求采购模块，节约了成本，因为框架一般很便宜 | 需要自己购买和安装扩展模块，需要一定的动手能力，比较麻烦 |
| 非模块化路由器 | 主要用于连接家庭或ISP内的小型企业客户。它不仅提供SLIP或PPP连接，还支持诸如PPTP和IPSec等虚拟私有网络协议 | 支持许多异构和高速端口，并在各个端口能够运行多种协议 | 一个端口的损坏需将设备上所有业务中断，设备下线更换，不支持功能扩展 |
| 无线路由器 | 带有无线覆盖功能的路由器，支持专线xdsl/ cable，动态xdsl，pptp等接入方式 | 将多种设备合而为一，亦比较适合于初次建网的用户，其集成化的功能可以使用户只用一个设备而满足所有的有线和无线网络需求 | 传输距离较短，一般不超过50米 |
| 无线网络路由器 | 是一种用来连接有线和无线网络的通讯设备，它可以通过Wi-Fi技术收发无线信号来与个人数码助理和笔记本等设备通讯 | 可以在不设电缆的情况下，方便地建立一个电脑网络 | 一般在户外通过无线网络进行数据传输时，它的速度可能会受到天气的影响 |

## 交换机
### 交换机（switch）是一种在通信系统中完成信息交换功能的设备，它应用在数据链路层。交换机有多个端口，每个端口都具有桥接功能，可以连接一个局域网或一台高性能服务器或工作站。实际上，交换机有时被称为多端口网桥。
### 交换机常见性能指标
1. 背板带宽
    * 定义：也叫背板容量，是交换机接口处理器或接口卡和数据总线间所能吞吐的最大数据量
    * 单位：Gbps
    * 计算公式：背板带宽=2 * 端口数 * 相应端口速率
    * 一般的交换机的背板带宽从几Gbps到上百Gbps不等
2. 交换容量
    * 定义：内核CPU与总线的传输容量，一般比背板带宽小
    * 单位：Gbps
    * 计算公式：交换容量=缓存位宽 * 缓存总线频率
3. 包转发率：
    * 定义：衡量网络设备转发数据能力的标准
    * 单位：pps
    * 计算：数据包packet和字节byte对应关系为1packet=64byte，网络中1个数据包最小包含64字节，这64个字节指的是单纯的数据，还要给每个数据包加上8byte的帧头和12byte的帧间隙，因此每传输一个数据包就需要传输64+8+12共84byte。一个1000Mbps的线速端口的最大包转发率为1,000,000,000bps/（84*8bit）≈1,488,095pps=1.488Mpps
    * 万兆线速端口包转发率14.88Mpps</br>千兆线速端口包转发率1.488Mpps</br>百兆线速端口包转发率0.1488Mpps

### 交换机分类
#### 二层交换机
* 二层交换技术的发展比较成熟，二层交换机属数据链路层设备，可以识别数据包中的MAC地址信息，根据MAC地址进行转发，并将这些MAC地址与对应的端口记录在自己内部的一个地址表中
* 二层交换机的特性：
    * 学习端口连接的机器的MAC地址，写入地址表，地址表的大小（一般两种表示方式：一为BEFFER RAM，一为MAC表项数值），地址表大小影响交换机的接入容量
    * 一般都含有专门用于处理数据包转发的ASIC（Application specific Integrated Circuit，专用集成电路）芯片，因此转发速度可以做到非常快
#### 三层交换机
* 三层交换机就是具有部分路由器功能的交换机，三层交换机的最重要目的是加快大型局域网内部的数据交换，所具有的路由功能也是为这目的服务的，能够做到一次路由，多次转发。三层交换技术是在网络模型中的第三层实现了数据包的高速转发，既可实现网络路由功能，又可根据不同网络状况做到最优网络性能
* 三层交换机的特性：
    * 高可扩充性：三层交换机在连接多个子网时，子网只是与第三层交换模块建立逻辑连接，不像传统外接路由器那样需要增加端口，从而保护了用户对校园网、城域教育网的投资。并满足学校3~5年网络应用快速增长的需要。
    * 高性价比：三层交换机具有连接大型网络的能力，功能基本上可以取代某些传统路由器，但是价格却接近二层交换机。一台百兆三层交换机的价格只有几万元，与高端的二层交换机的价格差不多。
    * 内置安全机制：三层交换机可以与普通路由器一样，具有访问列表的功能，可以实现不同VLAN间的单向或双向通讯。如果在访问列表中进行设置，可以限制用户访问特定的IP地址，这样学校就可以禁止学生访问不健康的站点，也可防止非法外部用户访问内部网络资源
    * 多媒体传输：教育网经常需要传输多媒体信息，这是教育网的一个特色。三层交换机具有QoS（服务质量）的控制功能，可以给不同的应用程序分配不同的带宽。例如，在校园网、城域教育网中传输视频流时，就可以专门为视频传输预留一定量的专用带宽，相当于在网络中开辟了专用通道，其他的应用程序不能占用这些预留的带宽，因此能够保证视频流传输的稳定性。
    * 计费功能：在高校校园网及有些地区的城域教育网中，很可能有计费的需求，因为三层交换机可以识别数据包中的IP地址信息，因此可以统计网络中计算机的数据流量，可以按流量计费，也可以统计计算机连接在网络上的时间，按时间进行计费。而普通的二层交换机就难以同时做到这两点。
#### 四层交换机
* 第四层交换机是基于传输层数据包的交换过程的，是一类基于TCP/IP协议应用层的用户应用交换需求的新型局域网交换机，支持TCP/UDP第四层以下的所有协议
* 四层交换机特性
    * 包过滤/安全控制：第四层交换区别于第三层交换的主要不同之处，就是在于这种过滤能力是在ASIC专用高速芯片中实现的，从而使这种安全过滤控制机制可以全线速地进行，极大地提高了包过滤速率。
    * 服务质量：在网络系统的层次结构中，TCP/UDP第四层信息，往往用于建立应用级通信优先权限。第四层交换机允许用基于目的地址、目的端口号（应用服务）的组合来区分优先级，于是紧急应用就可以获得网络的高级别服务。
    * 服务器负载均衡：在相似服务内容的多台服务器间提供平衡流量负载支持时，第四层信息是至关重要的。第四层交换机所支持的服务器负载均衡方式，是将附加有负载均衡服务的IP地址，通过不同的物理服务器组成一个集，共同提供相同的服务，并将其定义为一个单独的虚拟服务器。这个虚拟服务器是一个有单独IP地址的逻辑服务器，用户数据流只需指向虚拟服务器的IP地址，而不直接和物理服务器的真实IP地址进行通信。只有通过交换机执行的网络地址转换（NAT）后，未被注册IP地址的服务器才能获得被访问的能力。这种定义虚拟服务器的另一好处是，在隐藏服务器的实际IP地址后，可以有效地防止非授权访问。
    * 主机备用连接：主机备用连接为端口设备提供了冗余连接，从而在交换机发生故障时有效保护系统，这种服务允许定义主备交换机，同虚拟服务器定义一样，它们有相同的配置参数。由于第四层交换机共享相同的MAC地址，备份交换机接收和主单元全部一样的数据。这使得备份交换机能够监视主交换机服务的通信内容。主交换机持续地通知备份交换机第四层的有关数据、MAC数据以及它的电源状况。主交换机失败时，备份交换机就会自动接管，不会中断对话或连接。

## 评价
对于各种网络设备（包括宽带、路由器、交换机）的选择，需要根据实际的应用场景来决定适合的组合。就宽带而言，光纤以其高速率、稳定性、安全性无疑是最优的选择，而近年来上海一直在推进光纤入户，所以以前光纤一直存在的价格昂贵的缺点现在也可以克服，光纤几乎可以说是当下宽带的首选。交换机的作用主要是实现大家通过一根网线上网，一般情况下大家上网都是分别拨号的，都在使用自己的宽带，所以哪怕有人在下载其他东西，也自己上网也没有任何影响的，而且所有使用同一条交换机的电脑都在同一局域网内的。路由器比交换机多了虚拟拨号的功能，可以共用一个宽带账号，所以对于大家上网是会相互影响的，也就是说一台电脑在下载资料，其他电脑就会变得更卡的，网速会慢很多。对于家用而言，共享同一个宽带账号是比较普遍的选择，所以大多数人会选择使用路由器，而在大学寝室这个场景下，大家每个人都有属于自己的宽带账号，这时使用交换机上网可以保证上网不互相影响，也是不错的选择，当然交换机和路由器也可以搭配使用，对于企业而言可以将宽带线连接至路由器，再把路由器的输出宽带线连到交换机，通过交换机分开让数十台电脑使用。对于路由器和交换机各自不同的种类也需要根据使用场景需求的不同选购不同的种类。

------------------------
# xPU
## **GPU** - *Graphics Processing Unit*
### **图形处理器**（*GPU*），又称显示核心、视觉处理器、显示芯片，是一种专门在个人电脑、工作站、游戏机和一些移动设备（如平板电脑、智能手机等）上进行图像运算工作的微处理器。GPU的构成相对简单，有数量众多的计算单元和超长的流水线，特别适合处理大量的类型统一的数据。但有一点需要强调，虽然GPU是为了图像处理而生的，但是我们通过前面的介绍可以发现，它在结构上并没有专门为图像服务的部件，只是对CPU的结构进行了优化与调整，所以现在GPU不仅可以在图像处理领域大显身手，它还被用来科学计算、密码破解、数值分析，海量数据处理（排序，Map-Reduce等），金融分析等需要大规模并行计算的领域。所以GPU也可以认为是一种较 **通用** 的芯片。
### 供应商
* Intel
* NVIDIA
* AMD ( ATI )
* Matrox
* 3dfx、SiS、VIA
### 主要分类
* 独立显卡
* 集成绘图处理器
### 主要指标
* 频率
* CUDA核数量
* 存储器大小
* 计算性能峰值
* 存储器带宽（一个时钟周期内传输的数据位数）
### GPU具有如下特点：
1. 提供了多核并行计算的基础结构，且核心数非常多，可以支撑大量并行计算
2. 拥有更高的访存速度
3. 更高的浮点运算能力</br>
>
    随着人们的计算需求越来越专业化，人们希望有芯片可以更加符合自己的专业需求，这时，便产生了ASIC（专用集成电路）的概念。ASIC是指依产品需求不同而定制化的特殊规格集成电路，由特定使用者要求和特定电子系统的需要而设计、制造。当然这概念不用记，简单来说就是定制化芯片。

## **TPU** - *Tensor Processing Unit* &ensp;-&ensp; Google
### 张量处理器（TPU），是谷歌专门为加速深层神经网络运算能力而研发的一款芯片，其实也是一款ASIC。
### 原来很多的机器学习以及图像处理算法大部分都跑在GPU与FPGA（半定制化芯片）上面，但这两种芯片都还是一种通用性芯片，所以在效能与功耗上还是不能更紧密的适配机器学习算法，而且Google一直坚信伟大的软件将在伟大的硬件的帮助下更加大放异彩，所以Google便想，我们可不可以做出一款专用机机器学习算法的专用芯片，TPU便诞生了。
### 工艺指标
* TPU ASIC采用了28nm工艺制造，主频700MHz，功耗40W。
* 为了尽快把TPU部署到现有的服务器中，Google选择把这个芯片打包成外部扩展加速器，然后插到SATA硬盘插槽里使用。所以TPU通过PCIe Gen3 x16总线与主机相连，也就是说12.5GB/s的有效带宽。
### 技术
*  神经网络量化</br>

    通常而言，神经网络的预测不需要32位或16浮点计算精度，通过一些方法，可以用8位整数对神经网络进行预测，并保持适当的准确度。所谓量化，就是一种使用8位整数来近似预设的最小值和最大值之间任意数值的优化技术。
    * *降低神经网络预测成本*
    * *减少内存使用*：在Inception中应用量化之后，这个图像识别模型能从91MB压缩到23MB，成功瘦身四分之三。
    * *减小了TPU的硬件尺寸和功耗*：一个TPU钟包含65,536个8位整数乘法器。云环境中使用的主流GPU，通常包含数千个32位浮点乘法器。只要能用8位满足精度需求，就能带来25倍以上的性能提升。

* TPU指令集 & CISC</br>

    可编程性是TPU的另一个重要设计目标。TPU不是设计用来运行某一种神经网络，而是要能加速许多不同类型的模型。大多数当代CPU都采用了精简指令集(RISC)。但Google选择复杂指令集(CISC)作为TPU指令集的基础，这一指令集侧重于运行更复杂的任务。
    * TPU包括以下计算资源：
        * 矩阵乘法单元(MUX)：65,536个8位乘法和加法单元，运行矩阵计算
        * 统一缓冲(UB)：作为寄存器工作的24MB容量SRAM
        * 激活单元(AU)：硬件连接的激活函数
    
        为了控制MUX、UB和AU进行计算，Google定义了十几个专门为神经网络推理而设计的高级指令。简而言之，TPU设计封装了神经网络计算的本质，可以针对各种神经网络模型进行编程。为了编程，Google还创建了一个编译器和软件栈，将来自TensorFlow图的API调用，转化成TPU指令。

* 矩阵乘法单元的并行计算</br>

    典型的RISC处理器提供简单计算的指令，例如乘法或加法。这些事所谓的标量（Scalar）处理器，因为它们每个指令处理单一运算，即标量运算。即使主频千兆赫兹的CPU，仍然需要很长时间才能通过一系列标量运算来完成大型矩阵的计算。</br></br>
    改进的方法就是矢量（Vector）运算，同时针对多个数据元素执行相同的操作。
    GPU的流处理器（SM）就是一种高效的向量处理器，在单个时钟周期内，可以处理数百到数千次运算。</br>
    至于TPU，Google为其设计了MXU作为矩阵处理器，可以在单个时钟周期内处理数十万次运算，也就是矩阵（Matrix）运算。

* **脉动阵列**</br>

        在这种结构中，数据一波一波地流过芯片，与心脏跳动供血的方式类似。CPU和GPU在每次运算中都需要从多个寄存器（register）中进行存取；而TPU的脉动阵列将多个运算逻辑单元（ALU）串联在一起，复用从一个寄存器中读取的结果。

    MXU中的权值阵列专门为矩阵乘法运算进行了优化，并不适用于通用计算。MXU的脉动阵列包含256 × 256 = 65,536个ALU，也就是说TPU每个周期可以处理65,536次8位整数的乘法和加法。TPU以700兆赫兹的功率运行，也就是说，它每秒可以运行65,536 × 700,000,000 = 46万亿次乘法和加法运算，或每秒92万亿次矩阵单元中的运算。
    
    这种基于复杂指令集计算（CISC）的矩阵运算设计，实现了出色的性能功耗比：TPU的性能功耗比，比同时期的CPU强83倍，比同时期的GPU强29倍。

* 极简&确定性的设计
    * 单用途的TPU就是一个单线程芯片，不需要考虑缓存、分支预测、多道处理等问题。
    * TPU的控制单元更小，更容易设计，面积只占了整个冲模的2%，给片上存储器和运算单元留下了更大的空间。而且，TPU的大小只有其他芯片的一半。硅片越小，成本越低，良品率也越高。
    * 使用TPU能轻易预测运行一个神经网络、得出预测，需要多长时间，能让芯片以吞吐量接近峰值的状态运行，同时严格控制延迟。
    * 以MLP0为例，在同样将延迟控制在7毫秒之内的情况下，TPU的吞吐量是CPU和GPU的15到30倍。在六种神经网络上的性能对比，在CNN1上，TPU性能最为惊人，达到了CPU的71倍

## xPU-s
据说每过18天，集成电路领域就会多出一个XPU，直到26个字母被用完。
这被戏称为AI时代的xPU版摩尔定律。
据不完全统计，已经被用掉的有：
- **A**PU -- Accelerated Processing Unit, 加速处理器，AMD公司推出加速图像处理芯片产品。
- **B**PU -- Brain Processing Unit, 地平线公司主导的嵌入式处理器架构。
- **C**PU -- Central Processing Unit 中央处理器， 目前PC core的主流产品。
- **D**PU -- Deep learning Processing Unit, 深度学习处理器，最早由国内深鉴科技提出；</br>另说有Dataflow Processing Unit 数据流处理器， Wave Computing 公司提出的AI架构；</br>Data storage Processing Unit，深圳大普微的智能固态硬盘处理器。
- **F**PU -- Floating Processing Unit 浮点计算单元，通用处理器中的浮点运算模块。
- **G**PU -- Graphics Processing Unit, 图形处理器，采用多线程SIMD架构，为图形处理而生。
- **H**PU -- Holographics Processing Unit 全息图像处理器， 微软出品的全息计算芯片与设备。
- **I**PU -- Intelligence Processing Unit， Deep Mind投资的Graphcore公司出品的AI处理器产品。
- **MP**U/**MC**U -- Microprocessor/Micro controller Unit， 微处理器/微控制器，一般用于低计算应用的RISC计算机体系架构产品，如ARM-M系列处理器。
- **N**PU -- Neural Network Processing Unit，神经网络处理器，是基于神经网络算法与加速的新型处理器总称，如中科院计算所/寒武纪公司出品的diannao系列。
- **R**PU -- Radio Processing Unit, 无线电处理器， Imagination Technologies 公司推出的集合集Wifi/蓝牙/FM/处理器为单片的处理器。
- **T**PU -- Tensor Processing Unit 张量处理器， Google 公司推出的加速人工智能算法的专用处理器。目前一代TPU面向Inference，二代面向训练。
- **V**PU -- Vector Processing Unit 矢量处理器，Intel收购的Movidius公司推出的图像处理与人工智能的专用芯片的加速计算核心。
- **W**PU -- Wearable Processing Unit， 可穿戴处理器，Ineda Systems公司推出的可穿戴片上系统产品，包含GPU/MIPS CPU等IP。
- **X**PU -- 百度与Xilinx公司在2017年Hotchips大会上发布的FPGA智能云加速，含256核。
- **Z**PU -- Zylin Processing Unit, 由挪威Zylin 公司推出的一款32位开源处理器。